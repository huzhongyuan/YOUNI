<script type="text/javascript" src = "../js/module/header.js" data-css = "community" data-title = "community"></script>

<body>
		  <!-- È°µÂ§¥ÂºÄÂßã -->
    <header>
      <script type="text/javascript" src = "../js/module/nav.js"></script>
    </header>
          <!-- È°µÂ§¥ÁªìÊùü -->

          <div class="container" style="text-align:center;font-size:20px;width:940px;margin-top:30px;">
            <div class="notification">
              ËØùÈ¢òÁ§æÂå∫
            </div>
          </div>

          <article class="media" style="width:900px;margin:0px auto;margin-top:20px;">
            <figure class="media-left">
              <p class="image is-64x64">
                <!-- <img src="https://bulma.io/images/placeholders/128x128.png"> -->
              </p>
            </figure>

            <div class="media-content">
              <div class="field">
                <p class="control">

                  <input class="input" id="addTopicTitle" type="text" placeholder="Ê†áÈ¢ò" style="margin-bottom:20px;">
                  <textarea class="textarea" id="addTopicContent"  placeholder="Add a comment..."></textarea>
                </p>
              </div>
              <div class="field">
                <p class="control">
                  <input class="button is-success" id="publish" style="float:right;width:80px;" value="ÂèëË°®">
                </p>
              </div>
            </div>
          </article>

    <!-- ÂÜÖÂÆπÂºÄÂßã -->
    <div id="box" style="width:900px;margin: auto;">

<!-- ËøôÊòØ‰∏Ä‰∏™ËØÑËÆ∫Ê°Ü -->
<!-- <nav class="pagination is-centered" role="navigation" aria-label="pagination" style="background-color:white;margin-top:20px;">
  <a class="pagination-previous">Previous</a>
  <a class="pagination-next">Next page</a>
  <ul class="pagination-list">
    <li><a class="pagination-link" aria-label="Goto page 1">1</a></li>
    <li><span class="pagination-ellipsis">&hellip;</span></li>
    <li><a class="pagination-link" aria-label="Goto page 45">45</a></li>
    <li><a class="pagination-link is-current" aria-label="Page 46" aria-current="page">46</a></li>
    <li><a class="pagination-link" aria-label="Goto page 47">47</a></li>
    <li><span class="pagination-ellipsis">&hellip;</span></li>
    <li><a class="pagination-link" aria-label="Goto page 86">86</a></li>
  </ul>
</nav> -->
  </div>








      <!-- ÂÜÖÂÆπÁªìÊùü -->

        <!-- È°µËÑöÂºÄÂßã -->
    „ÄÄ<footer>
        <ul class="share-group">
          <li>1</li>
          <li>1</li>
          <li>1</li>
          <li>1</li>
          <li>1</li>
        </ul>
        <div class="copy">
            <span>¬©umeimmense</span>
        </div>

    </footer>
    <!-- È°µËÑöÁªìÊùü -->

    <div style="position:fixed;top:150px;right:50px;">
      <nav class="panel" id="topicBox">
        <p class="panel-heading">
          Á§æÂå∫ËØùÈ¢òÊêúÁ¥¢
        </p>
        <div class="panel-block">
          <p class="control has-icons-left">
            <input class="input is-small" type="text" placeholder="search">
            <span class="icon is-small is-left">
              <i class="fa fa-search"></i>
            </span>
          </p>
        </div>
        <p class="panel-tabs">
          ÁÉ≠ËÆÆÊ¶ú
        </p>


      </nav>
    </div>




		<!-- ÂÜÖÂÆπÁªìÊùü -->

		<!-- <script src="../js/size/TweenLite.min.js"></script>
		<script src="../js/size/EasePack.min.js"></script>
		<script src="../js/size/rAF.js"></script>
		<script src="../js/size/setsize.js"></script> -->
    <!-- ÂºïÂÖ•jqueryÊñá‰ª∂ -->
    <!-- <script type="text/javascript" src="../js/lib/jquery.min.js"></script> -->
    <!-- ÂºïÂÖ•bootstrap.min.jsÊñá‰ª∂ -->
    <!-- <script type="text/javascript" src="../bootstrap/js/bootstrap.min.js"></script> -->

		<div style="text-align:center;">
</div>
	</body>
  <script type="text/ecmascript">
  let addTopicTitle = document.getElementById('addTopicTitle');
  let addTopicContent = document.getElementById('addTopicContent');
  let publish = document.getElementById('publish');
  let topic = [];

  //ÁÇπÂáªÂèëË°®ËØùÈ¢ò
  publish.onclick = () => {
    if (addTopicTitle.value != '' && addTopicContent.value != '') {
      let sid = sessionStorage.getItem('sid');
      $.ajax({
        type: 'post',
        datType: 'json',
        url: 'http://192.168.1.102:8080/YouNi/topic.do',
        data: {
          s_id: sid,
          theme: addTopicTitle.value,
          description: addTopicContent.value,
        },
        success: function (json) {
          if (json.status == 1) {
            alert('ÂèëÂ∏ñÊàêÂäü');
            window.location.href = 'community.html';
          }else {
            alert('ÁΩëÁªúÈîôËØØ');
          }
        },

        error: function (json) {
          alert(JSON.stringify(json));
        },
      });
    }
  };

  //Âä†ËΩΩËØùÈ¢ò
  let getallTopic = new Promise((resolve, reject) => {
    let box = document.getElementById('box');
    $.ajax({
      type: 'get',
      datType: 'json',
      url: 'http://192.168.1.102:8080/YouNi/topic.do',
      success: function (json) {
        if (json.status == 1) {
          for (let i in json.object) {
            let ms = document.createElement('article');
            ms.className = 'media';
            ms.innerHTML = '<figure class="media-left">' +
            '<p class="image is-64x64">' +

            '</p>' +
            '</figure>' +
            '<div class="media-content">' +
            '<div class="content">' +
              '<p>' +
                '<span class="title" style="font-size:20px;">' + json.object[i].theme + '</span>' +
                '<br>' +
                '<span class="con">' + json.object[i].description + '</span>' +
                '<br>' +
                '<span class="name" style="font-size:14px;float:right;margin-right:80px;">' + '--' + json.object[i].userName + '</span>' +
                '<br>' +
                '<small style="float:right;margin-right:80px;"><span class="praise" style="cursor:pointer;">üëç</span><span class="num"> ' + json.object[i].praise_amount + ' </span> ¬∑ <span class="reply"  style="cursor:pointer;">ÂõûÂ§ç</span> ¬∑ 3 hrs</small>' +
                '<br>' +
                '<small style="float:right;margin-right:80px;font-size:12px;color:#cccccc;"><span class="view" style="color:#cccccc;">' + json.object[i].click_amount + '</span></small>' +
              '</p>' +
            '</div>' +
            '</div>';
            box.appendChild(ms);
            topic.push(json.object[i].topic_id);
          };

          resolve('Success!');
        }else {
          alert('ÁΩëÁªúÈîôËØØ');
        }
      },

      error: function (json) {
        alert(JSON.stringify(json));
      },
    });
  });

  //Âä†ËΩΩËØùÈ¢ò‰πãÂêéÁöÑÊìç‰Ωú
  getallTopic.then((successMessage) => {
    console.log(successMessage);
    //ÁÇπËµû
    (function () {
      let praise = document.getElementsByClassName('praise');
      let num = document.getElementsByClassName('num');
      let title = document.getElementsByClassName('title');
      let con = document.getElementsByClassName('con');
      let reply = document.getElementsByClassName('reply');
      for (let i in praise) {
        praise[i].onclick = () => {
          $.ajax({
            type: 'post',
            datType: 'json',
            url: 'http://192.168.1.102:8080/YouNi/praise/' + topic[i] + '.do',
            success: function (json) {
              if (json.status == 1) {
                num[i].innerHTML = json.praise_amount;
              }else {
                alert('ÁΩëÁªúÈîôËØØ');
              }
            },

            error: function (json) {
              alert(JSON.stringify(json));
            },
          });
        };

        //ÁÇπÂáªË∑≥ËΩ¨Âà∞ËØùÈ¢òËØ¶ÊÉÖ
        title[i].onclick = () => {
          sessionStorage.setItem('topicId', topic[i]);
          window.location.href = 'communityInfo.html';
        };

        con[i].onclick = () => {
          sessionStorage.setItem('topicId', topic[i]);
          window.location.href = 'communityInfo.html';
        };

        reply[i].onclick = () => {
          sessionStorage.setItem('topicId', topic[i]);
          window.location.href = 'communityInfo.html';
        };
      }
    })();

  });

  </script>
    <script type="text/javascript" src="../js/module/Communityhurdles.js"></script>
    <script type="text/javascript" src = "../js/module/footer.js"></script>
